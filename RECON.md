# RECONNAISSANCE (RECONOCIMIENTO)

La etapa de Reconocimiento varía entre ser útil e imprescindible en labores de seguridad ofensiva.  Conocida como RECON (también referenciada como OSINT por el empleo en gran medida de recursos de fuente abierta), es un conjunto de acciones que se deben llevar a cabo desde el inicio del pentest, pero, que incluso puede continuar llevándose en paralelo durante todo el proceso considerando que los resultados parciales puedan requerirlo.

## Information Gathering (Obtención de Información)

La obtención de información para un pentest puede ser sumamente escueta y más aún sí se refiere a un pentest tradicional de infraestructura. 
Por lo general, se limita a encontrar hosts expuestos (de forma interna y/o externa según el alcance del pentest). La información relevante son las direcciones IP y nombres DNS (Enumeración)

Sin embargo, el buscar información divulgada sobre los hosts en el alcance es relevante y debe ser reportada.  Un claro ejemplo son aquellos hosts que están registrados en bases de datos como la de SHODAN y que, basados en el banner, permite identificar las vulnerabilidades que cuentan con un registro CVE y que afectarían a estos hosts.

Otro aspecto en la búsqueda de información divulgada en la posibilidad de encontrar credenciales que aún sean válidas y emplearlas en algún proceso de autenticación que se encuentre expuesto. Otro tipo de información puede incluir detalles técnicos de la infraestructura o aplicaciones en el alcance.
Pero, la información más importante siempre serán los datos que pueden estar expuestos en repositorios de almacenamiento de archivos simples como los buckets/blobs que se encuentran expuestos.

## Enumeration (Enumeración)

La enumeración simple se refiere a obtener nombres DNS y direcciones IP de hosts activos.
El alcance y tiempo asignado al pentest así como la cantidad de pentesters asignados permitirá realizar labores de enumeración adicionales que se correspondan con dicho alcance.

La enumeración puede incluir la búsqueda de sub dominios DNS, servidores web virtuales, registros Whois, los proveedores del acceso a Internet, la protección en forma de servicios con la que cuentan, los hosts registrados en bases de datos de acceso público (sea pagado o no), screenshots de los webs, entre otros.

## Research (Investigación)

En este punto se analiza toda la información obtenida y se determina su usabilidad en base al alcance del pentest.  También, este análisis puede determinar que se requiera obtener información adicional o formatear los resultados en una forma específica y hasta alertar sobre un hallazgo temprano a la organización que ha requerido el pentest.

Es importante comprender que un pentest no implica analizar el valor de la información de manera independiente por parte de los pentesters.  Es una labor que debe realizarse en conjunto con las personas indicadas en la organización evaluada durante el pentest.

## Elementos empleados durante el RECON

### Motores de Búsqueda

- Google 
- Shodan
- BinaryEdge
- ZoomEye
- IntelX
- Lo mejor es hacer uso de consultas hechas mediante comandos como CURL o scripts/programas que hagan uso de las APIs provistas por los motores de búsqueda porque permiten trabajar mejor los resultados y en algunos casos se permiten realizar más consultas mediante las APIs que usando el browser.

### Basado en la perspectiva (Infraestructura)

#### EXTERNO

- Búsquedas DNS (directas y reversas). Siempre intentar la transferencia de zona DNS.
- Búsquedas de registros Whois a nivel de direcciones IP y nombres de dominio DNS.
- Hurricane Electric Internet Service (Internet Backbone) y otras bases de datos locales.
- Herramientas de búsqueda de sub dominios DNS como sublist3r o Sudomy (esta última incluye búsqueda de servidores web virtuales y obtener screenshots de los webs que se encuentren, entren otras cosas).
- Búsqueda de direcciones IP reales (cuando estan protegidas por servicios como CloudFlare) : SecurityTrails
- Búsquedad de recursos en proveedores de "nube" : Recon.Cloud

#### INTERNO

- Descubrimiento de targets activos usando NMAP : ``nmap -n -v -sn --reason ip_subnet -oA recon-ip_subnet-date``
- Por supuesto que la línea anterior no cubre todos los casos, pero, el resto de esfuerzos con NMAP implican escaneo de puertos a no ser que se solicite usar unicamente ICMP y/o ARP.

#### Aplicaciones 

- Como siempre en el caso de aplicaciones, el análisis de cada request y response es vital para conocer el entorno de la misma.
- Algunas herramientas como Wappalyzer o BuiltWith ayudan a tener información rapidamente aunque no siempre podrá acompañara a lo largo de todos los sistemas que comprenda una aplicación y en casos como las móviles, lo más útil seguirá siendo el aprender sobre las APIs utilizadas (más en un ambiente donde se tiende a las PWA).
- Herramientas como Burp (intruder) o Ffuf pueden ser utilizadas para el descubrimiento de endpoints tomando como base listas de palabras personalizadas. Sin embargo, lo más común es que este tipo de enumeración se realice como un paso adicional a las pruebas del descubrimiento realizado en el uso de la aplicación y como una forma de encontrar una falla de seguridad en un endpoint huerfano o expuesto directamente o por una condición no ejercitada.
- El caso de GraphQL es particular y una gran ayuda en un pentest si tiene habilitada la instrospección (introspection).
