# ANALYSIS (Análisis)

A pesar que esta etapa suele ser la menos deseada porque es común que las personas técnicas no gusten documentar, resulta que es la más importante de todo el proceso.
Sí se considera que un pentest tiene por objetivo ayudar a que la postura de seguridad de la organización evaluada sea mejor y no una demostración de las capacidades asombrosas de los pentesters, se entenderá que tanto la calificación del riesgo que representan las vulnerabilidades comprobadas como las recomendaciones específicas para resolver dichas vulnerabilidades, son lo más importante.

Esta etapa se puede ir desarrollando desde el inicio del proceso, no es necesario esperar al final.
Por ejemplo, reportar vulnerabilidades tradicionales de bajo riesgo (sí ha sido requerido por la organización evaluada), reportar hallazgos del tipo "informacion" y vulnerabilidades cuyo "encadenamiento" ya fue descartado, pueden ser reportadas.

Otra situación de análisis y reporte inmediato es cuando se encuentran vulnerabilidades cuya criticidad es muy alta.
Este aspecto tiene dependencias de la calificación de riesgo empleada por la organización evaluada (sea propia o por regulaciones) y puede ser sugerida por los pentesters.  
Por ejemplo, tomando como base las escalas cualitativas de PCI DSS, una vulnerabilidad cuya Puntuación Base llegue a 4 o más, puede ser considerado el umbral para reportar de inmediato una vulnerabilidad.  
Sí una regulación no es aplicable, CVSS también provee un mapeo de puntuación cuantitativa a cualitativa y, en ese caso, la vulnerabilidad se reportaría cuando la Puntuación Base sea de 7 o más.
Esto implica que se le analizó y calificó, pero, también, que ya se tienen una recomendación específica para el tratamiento del riesto que representa.

El reporte como tal, también, ha evolucionado y hoy en día es más común que se disponga de aplicaciones donde se puedan registrar los resultados y así realizar una mejor gestión en el tratamiento de las vulnerabilidades.

## Vulnerability Scoring (Calificación de Vulnerabilidades)

La calificación del riesgo que representa una vulnerabilidad que se está reportando para la organización evaluada es algo que se discute por mucho tiempo.
Existen propuestas diversas hechas por expertos individuales, por empresas del rubro, por organizaciones independientes y por entidades reguladoras o que proponen las regulaciones.

Lo más utilizado hasta el momento es CVSS (https://www.first.org/cvss/) porque permite analizar varios aspectos de las vulnerabilidades y esta ampliamente documentado.  Provee calificaciones cuantitativas y cualitativas (un mapeo entre ambas).
OWASP, también, provee una forma de calificación de riesgo (https://owasp.org/www-community/OWASP_Risk_Rating_Methodology).  Sin embargo, aunque plantea dos vectores aceptables (probabilidad versus impacto), aún sigue aceptando criterios subjetivos o que dependen mucho del criterio particular de cada pentester.

Al final, el resultado de un pentest es sumamente técnico y hacer un mapeo a los riesgos a los que terminan exponiendose los activos de información de la organización evaluada no es una labor de los pentesters.
Si acaso, el equipo de pentesters puede colaborar con los gestores de la seguridad de la información de la organización evaluada en tanto ellos manejan adecuadamente aspectos como el inventario y clasificación de activos de información, el análisis de riesgos correspondiente a dichos activos y los procesos de negocios.
Tal vez una excepción a esta regla se da cuando se realiza un pentest sobre aplicaciones bien conocidas o que son simples para el entendimiento de cualquier persona.  Una aplicación tipo banca por Internet o tienda virtual o procesamiento de pagos, etc. son de uso y conocimiento común, pero, aún así pueden haber reglas de negocio que no son conocidas ya que su manejo es interno (por ejmeplo, las reglas para evaluar el otorgamiento de un préstamo).
En esos casos, el equipo de pentesters puede ir más allá de solo reportar vulnerabilidades tradicionales y puede evaluar aquellas que permiten cometer fraudes o quebrar las reglas de negocio.

Las formas de realizar un pentest han variado mucho y, por ende, las formas de reportar también :
- Los informes impresos dejaron de usarse.
- Los informes en PDF son, comunmente, generados desde la aplicación que se usa para reportar los resultados.
- El proceso de "sustentación" detallado de los resultados mediante reuniones son más comúnes en los pentests tradicionales, pero, en modelos como Pentesting as a Service casi no existen estos procesos (se apoyan en medios de colaboración como Slack).
- El reportar vulnerabilidades puede concluir en la ocasión que se reportan por primera vez.  Sin embargo, los modelos tradicionales incluyen, cuando menos, un re-test (en el cual se comprueba si la vulnerabilidad fue tratada adecuadamente) y los modelos más nuevos pueden requerir reportar muchas veces sobre la misma vulnerabilidad (registrando unicamente las variaciones respecto al reporte inicial sobre las vulnerabilidades reportadas en él).
- El tiempo asignado a un pentest, también, impacta la entrega de resultados ya que puede haber o no tiempo para el entendimiento de la organización y los procesos/activos de información afectados por las vulnerabilidades reportadas.

## Report (Informe)

Algo que se mantiene de forma tradicional es que siempre se esperan dos grandes secciones en un informe : **Ejecutiva y Técnica.**

La Ejecutiva debe estar orientada a que los resultados del pentest puedan ser compartidos y entendidos por personas de áreas de seguridad y tecnología.  Esperar que un rol administrativo o gerencial o estratégico o de negocios pueda comprender los resultados aún a un nivel ejecutivo, no es factible.
Por ejemplo, un reporte que muestra una inyección de XXE sin su relacionamiento a como realizar un fraude es imposible de ser comprendida por los representantes del área de negocios que ha requerido la aplicación en la cual se encontró la vulnerabilidad mencionada.
Lo que si podrán entender es que se tenga una aplicación con una vulnerabilidad que permita quebrar una regla de negocios que haga perder o dejar de ganar dinero.

La Técnica puede consignar información diversa que dependa de lo requerido por la organización evaluada (por ejemplo, una lista de targets con sus puertos abiertos puede ser o no parte de la sección Técnica).
Aquello que siempre debe consignar es la documentación mas completa posible de las vulnerabilidades que se están reportando :
- Descripción específica para el pentest, no el concepto de la vulnerabilidad unicamente.
- Describir como se explota la vulnerabilidad. Sí se considera que es sencillo de recrear la comprobación de la vulnerabilidad, se debe incluir ejemplos con herramientas (incluyendo los parámetros empleados).
- Las evidencias correspondientes mediante screenshots.  Algunos solicitan videos y la verdad es que resulta casi imposible hacerlo en el tiempo asignado porque siempre resulta exacto e incluso corto.  Tal vez, los casos de protecciones que no han conseguido ser vulneradas puedan ser mejor documentadas con videos y para ello se sugiere usar herramientas como asciinema https://asciinema.org/
- Las recomendaciones deben ser específicas a nivel de opciones a seleccionar, parámetros a emplear, versiones de software a las cuales se deben actualizar, detalles de los workarounds.  En el caso de aplicaciones donde solamente se ha hecho DAST, debería incluirse un pseudocódigo.
- La calificación del riesgo que representa la vulnerabilidad.  Aplicando CVSS, por ejemplo.

## Elementos empleados durante el ANALYSIS

- https://www.first.org/cvss/calculator/3.1
- https://www.archerysec.com/

